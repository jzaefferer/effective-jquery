<!DOCTYPE html>
<html>
<head>
  <title>Effective jQuery - Patterns for maintainability and performance</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="theme/css/default.css">
  <base target="_blank">
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0" class="blur-none">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
    <aside class="note">
      <section>
        [screenflow start, manually, select projector!]<br>
        Have you heard about the car that was made entirely out of wood?<br>
        Yeah, it wooden move / or something about food for thought / Olá! How are you today?<br>
        I've got these [hold up five fingers] five patterns I want to talk about today. Each should help you use jQuery more effectively.<br>
        I selected these five from my work on jQuery UI and QUnit and other projects. To make them sticky, I came up with a few car and driving related analogies.<br>
        First, I have a quiz for you!
      </section>
    </aside>
    <hgroup>
      <h1>Effective jQuery</h1>
      <h2>Patterns for maintainability and performance</h2>
      <h3>
        Jörn <!--(as in "to <b>yearn</b> for something")--> Zaefferer<br>
        <a href="http://bassistance.de">bassistance.de</a> /
        <a href="https://twitter.com/bassistance">@bassistance</a>
      </h3>
    </hgroup>
  </slide>

  <slide>
    <aside class="note">
      <section>
        What is the most popular jQuery version on the jQuery CDN?<br>
        a, 1.4.2, b, 1.7.2, c, 1.9.1, d, 1.10.2?<br>
        who thinks its a? [wait] b? [wait] c? [wait] d? [wait] alright, most hands are for X<br>
        I will give the answer later, for now, let's look at the first pattern!
      </section>
    </aside>
    <hgroup>
      <h2>Quiz Time</h2>
      <h3>What is the most popular jQuery version on the jQuery CDN?</h3>
    </hgroup>
    <article>
      <ol class="build">
        <li>jquery-1.4.2.min.js</li>
        <li>jquery-1.7.2.min.js</li>
        <li>jquery-1.9.1.min.js</li>
        <li>jquery-1.10.2.min.js</li>
      </ol>
    </article>
  </slide>

  <!-- Write code like you spend fuel -->
  <slide class="segue big dark pattern-1">
    <aside class="note">
      <section>
        1. pattern: Write code like you spend fuel<br>
        I adapted this from Doug Neiner's "write code like you spend money".<br>
        When low on fuel, we don't drive as fast as possible to get to the next gas station<br>
        But when the tank is full and we're in a hurry, we can drive a little faster<br>
        How does this apply to JavaScript?<br>
        Let me show show you...
      </section>
    </aside>
    <hgroup>
      <h2>1. Write code like you spend fuel</h2>
      <h3>Adapted from Doug Neiner's Contextual jQuery series</h3>
    </hgroup>
  </slide>

  <slide>
    <aside class="note">
      <section>
        In JavaScript we have a choice <b>when</b> to run code<br>
        Before anything happens; on document ready; on window load;<br>
        Or, what I usually recommend: the one down here, commented as "cool place"<br>
        If you've got too much code running too early, it <b>will</b> slow down loading of the page<br>
        How can we address that?<br>
        Let's look at a few examples
      </section>
    </aside>
    <hgroup>
      <h2>Initializing JavaScript</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <head>
          <script class="blocks-page-rendering" src="jquery.js"></script>
          <script>
          superEarly();
          jQuery(document).ready(aLittleLaterStillEarly);
          jQuery(window).load(afterAllImagesLoaded);
          </script>
        </head>
        <body>
          <main>...</main>
          <script class="cool-place" src="jquery.js"></script>
          <script>
          // cool place
          `afterAllElementsRendered();`
          </script>
        </body>
      </textarea>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        In thist first one, there's several inputs with the autocomplete widget attached
        I click the first input, start typing<br>
        You see the menu showing suggestions<br>
        Each of those widgets is initialized just in time, not on page load!<br>
        With a lot of elements this is important - this table here could have hundreds of rows.<br>
        How does the just in time initialization work?
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init autocomplete demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/lazy-init-autocomplete.html"></iframe>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        This first input uses lazy initialization, with jQuery's .one() method<br>
        The event handler will run once, initialize the autocomplete, then remove itself<br>
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init an autocomplete widgets</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $("#autocomplete")`.one("focus"`, function() {
          $(this).autocomplete({
            source: names
          });
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        This gets more interesting when dealing with a lot of inputs, like a big table<br>
        Using event delegation needs only a single event handler on their common container<br>
        The selector includes a class that the event handler removes, that way each input is initialized only once, just in time
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init many autocomplete widgets</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        // initializing a big table with a few dozen or even hundreds of autocompletes on
        // page load would take a while, this is more efficient
        $("#accounts")`.on("focus", "input.autocomplete"`, function() {
          $(this)`.removeClass("autocomplete")`.autocomplete({
            source: names
          });
        });
      </textarea>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        This works for datepicker as well<br>
        Just emulate the default "on focus" behaviour by calling the show method<br>
        otherwise same approach as for autocomplete
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init datepickers</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $("#datepicker").one("focus", function() {
          $(this).datepicker()`.datepicker("show")`;
        });

        $("#accounts").on("focus", "input.datepicker", function() {
          $(this).removeClass("datepicker").datepicker()`.datepicker("show")`;
        });
      </textarea>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        quick demo of datepicker, no surprises here either
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init datepicker demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/lazy-init-datepicker.html"></iframe>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        dialog's usually have a trigger, so we can make use of that<br>
        Auto opens on init, manually open later
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init dialogs</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <a href="#contact-us-dialog" class="dialog">Contact Us</a>
        <div id="contact-us-dialog">Contact us today!</div>
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        var trigger = $(".dialog");
        var dialog = $(trigger.attr("href")).hide();
        trigger.click(function(event) {
          event.preventDefault();
          if (dialog.data("ui-dialog")) {
            dialog.dialog("open");
          } else {
            dialog.dialog();
          }
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Again, no surprise here<br>
        [click the link to open the dialog]
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init dialog demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/lazy-init-dialog.html"></iframe>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        Event delegation can also be used for form validation<br>
        Even works for clicks on the submit button
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init form validation</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $("form").one("focusin", function() {
          $(this).validate();
        });
      </textarea>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        [Click submit button]<br>
        See, submit event is triggered after focusin<br>
        In addition to these demos, I want to show you an example of lazy initialization in the wild
      </section>
    </aside>
    <hgroup>
      <h2>Lazy init form validation demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/lazy-init-form-validation.html"></iframe>
    </article>
  </slide>

  <slide class="fill">
    <aside class="note">
      <section>
        This is from a german IT news site<br>
        Instead of loading "social" widgets on page load<br>
        They introduced an extra click. Good for performance AND privacy.<br>
        Options to always load some or all of them. [point at the checkboxes in popup]<br>
        That concludes the first pattern, "Write code like you spend fuel"<br>
        Coming up next:
      </section>
    </aside>
    <img src="images/heise-social-two-clicks.png">
    <hgroup class="img-overlay" style="width:420px;top:70%">
      <h2>heise.de two clicks for more privacy</h2>
    </hgroup>
  </slide>



  <!-- Write code like you don't know the road -->
  <slide class="segue big dark pattern-2">
    <aside class="note">
      <section>
        2. pattern: Write code like you don't know the road<br>
        This one is about the interaction between JavaScript, HTML and CSS<br>
        Its common to change markup to allow changes in CSS.<br>
        But this can break brittle JS code.
      </section>
    </aside>
    <hgroup>
      <h2>2. Write code like you don't know the road</h2>
      <h3>Someone is going to mess up the HTML</h3>
    </hgroup>
  </slide>
  <slide>
    <aside class="note">
      <section>
        This demo has an element that can be dragged by its handle<br>
        The handle shows up on hover<br>
        I can drag around with the mouse<br>
        This is just a simple demo. Imagine what would happen when one change request after the other requires changing the markup of this element.<br>
        It would probably break our underlying JavaScript. Let's check the code!
      </section>
    </aside>
    <hgroup>
      <h2>Flexible draggable handle demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/flexible.html"></iframe>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        At the top is the markup, below the JS applied to that<br>
        This uses the children method to find the handle container<br>
        This would break when the handle ends up wrapped in another element<br>
        Instead of the children() method, we can use the find() method to avoid that<br>
        Doug Neiner called these 'flexible' and 'brittle' methods
      </section>
    </aside>
    <hgroup>
      <h2>Traversing example</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <div class="dragme">
          <span `class="handle-container"`>
            <span class="handle"></span>
          </span>
          <p>Actual text content comes here</p>
        </div>
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        $(".dragme").hover(function() {
          $(this)`.children(".handle-container")`.show();
        }, function() {
          if (document.activeElement !== this) {
            $(this)`.children(".handle-container")`.hide();
          }
        }).draggable({
          handle: ".handle-container"
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        You should use flexible traversing methods<br>
        These are less likely to break when making changes<br>
        For the given example, its really easy to apply:
      </section>
    </aside>
    <hgroup>
      <h2>Flexible over brittle traversing methods</h2>
      <h3>Use <b>flexible</b> methods!</h3>
    </hgroup>
    <article>
      <ul>
        <li>prevAll > prev</li>
        <li>nextAll > next</li>
        <li>closest > parent</li>
        <li>find > children</li>
      </ul>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Just replace children() with find()<br>
        If we were to change the markup now, the JS would continue to work without changes
      </section>
    </aside>
    <hgroup>
      <h2>Flexible over brittle traversing example</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <div class="dragme">
          <span `class="handle-container"`>
            <span class="handle"></span>
          </span>
          <p>Actual text content comes here</p>
        </div>
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        $(".dragme").hover(function() {
          $(this)`.find(".handle-container")`.show();
        }, function() {
          if (document.activeElement !== this) {
            $(this)`.find(".handle-container")`.hide();
          }
        }).draggable({
          handle: ".handle-container"
        });
      </textarea>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        What does this?<br>
        Matches if the next sibling is a div<br>
        Would break if any other element is inserted inbetween.
      </section>
    </aside>
    <hgroup>
      <h2>Flexible over brittle traversing example</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $("a").next("div")
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Here if looks through next siblings until it finds a div and matches only that.<br>
        Allows you to insert other siblings without breaking this traversal.
      </section>
    </aside>
    <hgroup>
      <h2>Flexible over brittle traversing example</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $("a").nextAll("div:first")
      </textarea>
    </article>
  </slide>

  <slide>
    <aside class="note">
      <section>
        The same applies to selectors, for example in the context of event delegation.<br>
        Pick the more flexible selector here, since clicks don't happen often.<br>
        Here's its better to match clicks based on the href, instead of relying on a specific class<br>
        So, write code like you don't know the road. Use <b>flexible</b> methods and selectors.<br>
        Which also applies to the next pattern:
      </section>
    </aside>
    <hgroup>
      <h2>Flexible over brittle selectors</h2>
      <h3>Use flexible selectors!</h3>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        var selector = moreFlexible ? "a.twitter" : `"a[href*=twitter.com]"`;
        $("main").on("click", selector, function() {});
      </textarea>
    </article>
  </slide>



  <!-- Write code like you avoid traffic jams -->
  <slide class="segue big dark pattern-3">
    <aside class="note">
      <section>
        3. pattern: Write code like you avoid traffic jams<br>
        Traffic jams are like performance bottlenecks<br>
        Always thinking about traffic jams is a waste of time<br>
        But we can avoid well known rush hours!<br>
        When it comes to jQuery, there's a few traffic jams we can look out for<br>
        Usually having thousands of elements on a page will cause jams<br>
        Doing lots of processing in mousemove events is also a bad idea<br>
      </section>
    </aside>
    <hgroup>
      <h2>3. Write code like you avoid traffic jams</h2>
    </hgroup>
  </slide>

  <slide>
    <aside class="note">
      <section>
        Occasionally its less obvious.<br>
        Here's some jQuery code that creates a list of items, which looks pretty innocent.<br>
        It sets text and data for each list item,<br>
        Then each item is added to a jQuery object, which is then added to the page<br>
        Just one DOM operation, so why does it take more then two seconds for just 400 items?<br>
        This is a good opportunity to use a profiler
      </section>
    </aside>
    <hgroup>
      <h2>Why does this take >2 seconds?!</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <ul id="list"></ul>
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        var items = $([]);
        console.time('add');
        for (var i=0; i &lt; 400; i++) {
          var item = $("&lt;li>").text("item" + i).data("item-index", i);
          items = items.add(item);
        }
        console.timeEnd('add'); // add: 2317.313ms
        $("#list").append(items);
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        When I ran into this problem, I could already tell which part of my code was responsible<br>
        It looked something like this<br>
        I couldn't tell why it was so slow, so I added these profile calls around it [activate highlight]<br>
        I then ran the code again and looked at the profile that Chrome created
      </section>
    </aside>
    <hgroup>
      <h2>Use profiler to find out!</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <ul id="list"></ul>
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        var items = $([]);
        `console.profile('add');`
        for (var i=0; i &lt; 400; i++) {
          var item = $("&lt;li>").text("item" + i).data("item-index", i);
          items = items.add(item);
        }
        `console.profileEnd('add');`
        $("#list").append(items);
      </textarea>
    </article>
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        here's a screenshot of Chrome's flame graph of a profile<br>
        hovering elements will show details
      </section>
    </aside>
    <img src="images/add-slow-flamegraph.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        here are the details for the add method<br>
        total time is high, self time is low<br>
        we can see in the graph that add is calling uniqueSort...
      </section>
    </aside>
    <img src="images/add-slow-flamegraph-add-method.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        which has pretty much the same total time, but lots more self time<br>
        so probably most time is spent here<br>
        When digging into this, I learned that this isn't a new issue, has actually been around for a long time<br>
        Other methods had this problem as well, got fixed back around jQuery 1.5, including these graphs in the release blog post
      </section>
    </aside>
    <img src="images/add-slow-flamegraph-uniquesort.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        here the 1.4.4 performance in blue, 1.5 in green<br>
        for the children method
      </section>
    </aside>
    <img src="images/jquery-1-5-perf-graph-children.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        next and prev also got a lot faster<br>
        children, next and prev used to call uniqueSort, which sorts selected elements in DOM order<br>
        the add() method is slow, since it still sorts, but luckily its really easy to work around that...
      </section>
    </aside>
    <img src="images/jquery-1-5-perf-graph-next.jpg">
  </slide>

  <slide>
    <aside class="note">
      <section>
        Here's pretty much the same code, replacing the jQuery object with a plain array<br>
        Takes less then 60ms, so much much faster<br>
        Again: Write code like you avoid traffic jams!<br>
        In this case, the answer could be found in JavaScript<br>
        In other cases, we have to look a little further<br>
        Which brings us to:
      </section>
    </aside>
    <hgroup>
      <h2>Runs in &lt;60ms!</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="html">
        <ul id="list"></ul>
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        // var items = $([]);
        `var items = []`;
        console.time('add');
        for (var i=0; i &lt; 400; i++) {
          var item = $("&lt;li>").text("item" + i).data("item-index", i);
          // items = items.add(item);
          `items.push(item);`
        }
        console.timeEnd('add'); // add: 55.338ms
        $("#list").append(items);
      </textarea>
    </article>
  </slide>



  <!-- Combine tools like you'd park and ride -->
  <slide class="segue big dark pattern-4">
    <aside class="note">
      <section>
        4. pattern: Combine tools like you would park and ride<br>
        jQuery pioneered a lot of new APIs<br>
        Most are now available in the browser without libraries, via JavaScript, like querySelectorAll or classList.<br>
        One particular new API got exposed via CSS: Transitions<br>
        Since jQuery animations tend to be very slow on mobile devices, CSS transitions are quite valuable there<br>
        They don't replace jQuery, but combining both is very poweful
      </section>
    </aside>
    <hgroup>
      <h2>4. Combine tools like you'd park and ride</h2>
    </hgroup>
  </slide>
  <slide>
    <aside class="note">
      <section>
        let's start with a demo<br>
        this page implements a custom tooltip on anchors<br>
        [slowly hover the elements]
        Let's look at the options for implementing these fade animations
      </section>
    </aside>
    <hgroup>
      <h2>Custom tooltip demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/transitions.html"></iframe>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        here's the CSS for a custom tooltip using transitions for the fade effect<br>
        a lot of this is just general styling<br>
        [activate highlight]<br>
        relevant for the transition is opacity and transition<br>
        let's look at the javascript for that
      </section>
    </aside>
    <hgroup>
      <h2>Custom tooltip with CSS transitions</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="css">
        .tooltip {
          top: 0;
          left: 0;
          position: absolute;
          background: #eee;
          border: 1px solid #ddd;
          border-radius: 3px;
          padding: 8px;
          `opacity: 0;`
          `transition: opacity 0.4s ease-in-out;`
        }
        `.tooltip-visible` {
          `opacity: 1;`
        `}`
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Implementing the tooltip in JavaScript involves creating a tooltip element<br>
        Positioning that in the right place, setting the text and removing the title attribute<br>
        Once all that is done, the "tooltip-visible" class is added.<br>
        All that happens on mouseenter; on mouseleave, the title is restored and the class is removed.<br>
        This works, but we can also control the transition from JavaScript
      </section>
    </aside>
    <hgroup>
      <h2>Custom tooltip with CSS transitions</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        var tooltip = $("<div>").addClass("tooltip").appendTo(document.body),
          title;
        $("a[title]")`.mouseenter(`function(event) {
          title = this.title;
          this.title = "";
          tooltip.text(title).css({
            left: event.pageX + 10,
            top: event.pageY + 10
          })
          `.addClass("tooltip-visible");`
        })`.mouseleave(`function() {
          this.title = title;
          `tooltip.removeClass("tooltip-visible");`
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Same tooltip example, now using the transit plugin, no longer specifying transitions in CSS<br>
        Instead of adding and removing the tooltip-visible class, we specify the properties to transition in a call to the transition methods<br>
        This also sets `queue:false` to achieve the same behaviour as CSS transitions, avoiding animations to queue up when hovering between elements with the tooltip attached
      </section>
    </aside>
    <hgroup>
      <h2>Custom tooltip with using <a href="http://ricostacruz.com/jquery.transit/">transit plugin</a></h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        var tooltip = [...],
          title;
        $("a[title]").mouseenter(function(event) {
          /* as before: set title, position tooltip */
          tooltip`.transition({`
            `queue: false,`
            `opacity: 1`
          });
        }).mouseleave(function() {
          this.title = title;
          `tooltip.transition({`
            `opacity: 0`
          });
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        why pick one over the other?<br>
        <b>preference</b>: declared in CSS vs JS, if all else being equal, pick what you like more<br>
        <b>control</b>: queue multiple transitions, impossible with CSS transitions<br>
        <b>fallbacks</b>: when desired, really easy to do with transit plugin... [next slide mentions CSS Transitions fallback handling]
      </section>
    </aside>
    <hgroup>
      <h2>CSS transitions: declarative or not?</h2>
      <h3>Matter of <b>preference</b>, <b>control</b> and <b>fallbacks</b></h3>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="css">
        .tooltip {
          opacity: 0;
          transition: opacity 0.4s ease-in-out;
        }
        .tooltip-visible {
          opacity: 1;
        }
      </textarea>
      <textarea class="prettyprint" data-lang="js">
        tooltip.transition({
          queue: false,
          opacity: 1
        });
        tooltip.transition({
          opacity: 0
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        fallback to jQuery animations when transitions aren't available<br>
        only when desired, since CSS transitions fall back to instantly changing styles, good enough most of the time<br>
        Some animations are impossible to implement with CSS, like page scroll...
      </section>
    </aside>
    <hgroup>
      <h2>Fallback to jQuery animations</h2>
      <h3>For supported properties</h3>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        // Delegate .transition() calls to .animate() if the browser can't do CSS transitions.
        // Only works for properties that jQuery can handle; x/y won't work
        if (!$.support.transition) {
          $.fn.transition = $.fn.animate;
        }
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Clicking this button will do an animated page scroll<br>
        That's impossible to implement with CSS
      </section>
    </aside>
    <hgroup>
      <h2>Animated page scroll demo</h2>
    </hgroup>
    <article>
      <iframe src="demos/transitions.html"></iframe>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        For that we can still use jQuery.<br>
        Note that the complete callback, the one we pass to the animate method, runs for both elements.
      </section>
    </aside>
    <hgroup>
      <h2>Animated page scroll</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $( "html, body" ).animate({
          // scroll to end of page
          scrollTop: $(document).height()
        }, 800, function() {
          console.log("runs twice");
        });
      </textarea>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Using .promise().then() will provide a single callback.<br>
        That brings us to the fifth and last pattern.
      </section>
    </aside>
    <hgroup>
      <h2>Animated page scroll</h2>
    </hgroup>
    <article>
      <textarea class="prettyprint" data-lang="js">
        $( "html, body" ).animate({
          // scroll to end of page
          scrollTop: $(document).height()
        }, 800).promise().then(function() {
          console.log("runs once!")
        });
      </textarea>
    </article>
  </slide>



  <!-- Customize widgets like customizing a car -->
  <slide class="segue big dark pattern-5">
    <aside class="note">
      <section>
        5. pattern: Customize widgets like customizing a car<br>
        These days you can pick much more then just the color when buying a new car<br>
        New or used, you can also customize yourself<br>
        How does this apply to JS? For example, jQuery UI widgets come with a selection of themes<br>
        You can pick one that comes close, then adjust some details manually<br>
        Let's look at a demo of customized widgets, using jQuery UI tabs and datepicker
      </section>
    </aside>
    <hgroup>
      <h2>5. Customize widgets like customizing a car</h2>
    </hgroup>
  </slide>

  <slide>
    <aside class="note">
      <section>
        There's the tab widget with three tabs<br>
        And an inline datepicker on the first tab<br>
        This is using an original theme provided by ThemeRoller, called Flick<br>
      </section>
    </aside>
    <hgroup>
      <h2>Flick theme, original CSS</h2>
    </hgroup>
    <article>
      <iframe src="demos/custom-widget.html?nocustom"></iframe>
    </article>
  </slide>
  <slide>
    <aside class="note">
      <section>
        Here are the same widgets with the same theme, but with a few modifications<br>
        I made the tab headers stand out and added icons<br>
        I removed some spacing on the datepicker to match the tabs<br>
        This took just a few lines of CSS, nothing magic<br>
        [mouse around to show hover styles]
      </section>
    </aside>
    <hgroup>
      <h2>Flick theme, custom CSS</h2>
    </hgroup>
    <article>
      <iframe src="demos/custom-widget.html"></iframe>
    </article>
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        Here's an edited screenshot of jQuery UI's download builder, showing you the widgets and theme I selected for this demo.<br>
        Its really easy to build a custom download with a custom theme.
      </section>
    </aside>
    <img src="images/download-builder-datepicker-tabs-flick.png">
  </slide>

  <slide>
    <aside class="note">
      <section>
        When you don't want to use any of the stock themes, you have a few options for customizing widgets.<br>
        You can use jQuery UI's ThemeRoller to customize one of the stock themes. That might be enough<br>
        You could use a stock theme and create a simple stylesheet that overrides a few properties. This is what I did in the previous demo.<br>
        You could the structure CSS file for widgets and write a custom theme<br>
        Or you could write everything from scratch. This would be the most effort, but also gives you most control and you don't have to override any existing styles.<br>
        I want to show you a few examples for the last two of these.
      </section>
    </aside>
    <hgroup>
      <h2>Options for CSS customization</h2>
      <!-- <h3>Use <b>flexible</b> methods!</h3> -->
    </hgroup>
    <article>
      <ul class="build">
        <li>ThemeRoller</li>
        <li>Overrides</li>
        <li>Use structure.css, write theme from scratch</li>
        <li>Everything from scratch</li>
      </ul>
    </article>
  </slide>

  <!-- mybalsamiq screenshots -->
  <slide class="full nobackground">
    <aside class="note">
      <section>
        from mybalsamiq, a tool for creating mockups<br>
        customized menu with icons and shortcuts to change project style<br>
        This uses the structure CSS from jQuery UI with a fully custom theme
      </section>
    </aside>
    <img src="images/mybalsamiq-menu1.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        mybalsamiq also uses custom tooltips on the icons<br>
        like the "Launch Prototype" around the top right
      </section>
    </aside>
    <img src="images/mybalsamiq-tooltip.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        there's a dialog with two tabs, for uploading assets<br>
        the tabs headers are embedded in the dialog header<br>
        saves screen estate and looks nice
      </section>
    </aside>
    <img src="images/mybalsamiq-tabbed-dialog.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        Last one from mybalsamiq: the access slider<br>
        Here a customized slider with extra labels for each step.<br>
        These are examples of custom widgets that you can fit into your design,<br>
        while you benefit from their great UX and accessibility.
      </section>
    </aside>
    <img src="images/mybalsamiq-access-slider.png">
  </slide>

  <!-- custom datepickers -->
  <slide class="full nobackground">
    <aside class="note">
      <section>
        Here's a stock datepicker with a fully custom theme, embedded in a custom calendar control<br>
        This doesn't use any of the original CSS, its all custom.
      </section>
    </aside>
    <img src="images/datepicker-custom-theme1.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        The same datepicker, on a booking site, with its own fully customized theme. The basic layout is the same, but that's all it has in common with the default theme.<br>
        If you don't like the ThemeRoller themes and don't want to build your own
      </section>
    </aside>
    <img src="images/datepicker-custom-theme2.png">
  </slide>

  <!-- wijmo screenshots -->
  <slide class="full nobackground">
    <aside class="note">
      <section>
        there's more<br>
        wijmo provides several good themes, like aristo
      </section>
    </aside>
    <img src="images/wijmo-aristo.png">
  </slide>
  <slide class="full nobackground">
    <aside class="note">
      <section>
        Or this "midnight" theme.<br>
        They've got more themes and more widgets, too.<br>
        All that to say: <b>Unless</b> building widgets is your core business,<br>
        Don't build widgets from scratch, just like you wouldn't build a car from scratch, since you would waste a lot of time and miss a lot of details.<br>
        Which brings us to the end, so its time to ... resolve the quiz!
      </section>
    </aside>
    <img src="images/wijmo-midnight.png">
  </slide>



  <!-- outro -->
  <slide>
    <aside class="note">
      <section>
        Everyone who guessed C was right! The actual top-three is this<br>
        By the way, the top file here had, within a month, 1.5 <b>billion</b> hits, using 45 TerraBytes of bandwidth.<br>
        With that out of the way, I'd like to quickly recap what we looked at...
      </section>
    </aside>
    <hgroup>
      <h2>Quiz Time Answer</h2>
      <h3>What is the most popular jQuery version on the jQuery CDN?</h3>
    </hgroup>
    <article>
      <ol style="list-style-type:decimal;">
        <li><b>jquery-1.9.1.min.js</b>, #1, 1553m hits, 45 TB</li>
        <li>jquery-1.7.2.min.js, #2, 1451m hits, 56 TB</li>
        <li>jquery-1.10.2.min.js, #4, 1146m hits, 37 TB</li>
        <li>jquery-1.4.2.min.js, #15, 22m hits, 0.5 TB</li>
      </ol>
    </article>
  </slide>
  <slide class="segue big dark pattern-1">
    <aside class="note">
      <section>
        Write code like you spend fuel - plan ahead, spend as necessary, keep a reserve
      </section>
    </aside>
    <hgroup>
      <h2>1. Write code like you spend fuel</h2>
      <h3>plan ahead, spend as necessary, keep a reserve</h3>
    </hgroup>
  </slide>
  <slide class="segue big dark pattern-2">
    <aside class="note">
      <section>
        Write code like you don't know the road - be flexible, avoid brittle methods and selectors
      </section>
    </aside>
    <hgroup>
      <h2>2. Write code like you don't know the road</h2>
      <h3>be flexible, avoid brittle methods and selectors</h3>
    </hgroup>
  </slide>
  <slide class="segue big dark pattern-3">
    <aside class="note">
      <section>
        Write code like you avoid traffic jams - avoid JavaScript rush hours, use a profiler when you run into unexpected bottlenecks
      </section>
    </aside>
    <hgroup>
      <h2>3. Write code like you avoid traffic jams</h2>
      <h3>avoid JavaScript rush hours, use a profiler when you run into unexpected bottlenecks</h3>
    </hgroup>
  </slide>
  <slide class="segue big dark pattern-4">
    <aside class="note">
      <section>
        Combine tools like you'd park and ride - make use of CSS transitions, combine with jQuery
      </section>
    </aside>
    <hgroup>
      <h2>4. Combine tools like you'd park and ride</h2>
      <h3>make use of CSS transitions, combine with jQuery</h3>
    </hgroup>
  </slide>
  <slide class="segue big dark pattern-5">
    <aside class="note">
      <section>
        Customize widgets like customizing a car - don't build widgets from scratch when you can customize them
      </section>
    </aside>
    <hgroup>
      <h2>5. Customize widgets like customizing a car</h2>
      <h3>don't build widgets from scratch when you can adjust them to your needs</h3>
    </hgroup>
  </slide>

  <!-- closing -->
  <slide class="thank-you-slide">
    <aside class="note">
      <section>
        "here are contact details and links to slides and resources"<br>
        If Q/A time: "and we have time for questions!"<br>
        Once done, "Alright, that was the last question, thank you very much!"<br>
        Otherwise: "unfortunately we don't have time for questions. Thank you very much!"
      </section>
    </aside>
    <article>
      <ul>
        <li><span>twitter</span><a href="http://twitter.com/@bassistance">@bassistance</a></li>
        <li><span>email</span><a href="mailto:joern.zaefferer@gmail.com">joern.zaefferer@gmail.com</a></li>
        <li><span>web</span><a href="http://bassistance.de">bassistance.de</a></li>
        <li><span>resources</span><a href="https://github.com/jzaefferer/effective-jquery">github.com/jzaefferer/effective-jquery</a></li>
        <li><span>slides</span><a href="http://jzaefferer.github.io/effective-jquery/">jzaefferer.github.io/effective-jquery/</a></li>
      </ul>
    </article>
  </slide>


  <slide class="backdrop"></slide>

</slides>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
